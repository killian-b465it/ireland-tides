<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description"
    content="Real-time tide data for fishing around Ireland's coast. View current water levels, high/low tide times, and fishing conditions for all Irish coastal locations.">
  <title>Irish Fishing Hub - Real-Time Fishing Tide Data</title>

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">

  <!-- Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="">

  <!-- App Styles -->
  <link rel="stylesheet" href="style.css">

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
  <!-- Adsterra Native Banner Integration -->
  <script async="async" data-cfasync="false"
    src="https://pl28620895.effectivegatecpm.com/eebc42a1bc18608e22c241b4e8ae00ec/invoke.js"></script>

  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4749246157404876"
    crossorigin="anonymous"></script>


</head>

<body>
  <!-- Loading Screen -->
  <div id="loading-screen">
    <div class="loading-content">
      <h1 class="welcome-text">Welcome</h1>
      <h2 class="sub-welcome-text">Irish Fishing Hub</h2>
      <div class="loading-logo-wrapper">
        <div class="water-wave">ğŸŒŠ</div>
      </div>
    </div>
  </div>

  <!-- Irish Fishing Hub v1.1.1 Official Release -->

  <!-- Navigation bar -->
  <nav class="navbar">
    <div class="nav-container">
      <div class="nav-links">
        <a href="#" class="nav-link" id="nav-community" onclick="showPage('community')">Community</a>
        <a href="#" class="nav-link" id="nav-sponsors" onclick="showPage('sponsors')">Sponsors</a>
        <a href="#" class="nav-link" id="nav-directory" onclick="showPage('directory')">Shop Directory</a>
        <a href="#" class="nav-link admin-only" id="nav-admin" onclick="showPage('admin')" style="display: none;">ğŸ›¡ï¸
          Admin</a>
      </div>

      <div class="nav-brand">
        <img src="assets/logo.png" alt="Logo" class="nav-logo-img"
          style="height: 32px; width: 32px; margin-right: 8px;">
        <span class="nav-title">Irish Fishing Hub</span>
      </div>

      <div class="nav-right">
        <a href="https://www.buymeacoffee.com/AppDev21" target="_blank" class="btn btn-sm"
          style="margin-right: 15px; display: flex; align-items: center; gap: 5px; text-decoration: none; color: #ffab00 !important; border: 1px solid #ffab00 !important; background: transparent;">
          <span style="font-size: 1.2rem;">ğŸ£</span> Support Development
        </a>
        <div class="nav-auth">
          <button class="btn btn-sm btn-outline" id="login-btn" onclick="openAuthModal()">Login/Signup</button>
          <div id="user-display" style="display: none;" onclick="openProfileModal()">
            <span id="user-name-label">User</span>
            <div class="user-avatar-wrapper">
              <div class="user-avatar">ğŸ‘¤</div>
              <span class="notification-badge" id="notification-badge" style="display: none;">0</span>
            </div>
          </div>
        </div>
        <div class="nav-live">
          <div class="live-indicator">
            <span class="live-dot"></span>
            <span>LIVE</span>
          </div>
          <span id="current-time"></span>
        </div>
        <!-- Mobile Menu Button -->
        <button class="hamburger-btn" id="hamburger-btn" onclick="toggleMobileMenu()">
          <span style="display:block;width:18px;height:3px;background:#fff;border-radius:2px;"></span>
          <span style="display:block;width:18px;height:3px;background:#fff;border-radius:2px;"></span>
          <span style="display:block;width:18px;height:3px;background:#fff;border-radius:2px;"></span>
        </button>
      </div>
    </div>
    <!-- Mobile Dropdown Menu -->
    <div class="mobile-menu" id="mobile-menu">
      <a href="#" class="mobile-menu-link" onclick="showPage('home'); closeMobileMenu()">Dashboard</a>
      <a href="#" class="mobile-menu-link" onclick="showPage('community'); closeMobileMenu()">Community</a>
      <a href="#" class="mobile-menu-link" onclick="showPage('sponsors'); closeMobileMenu()">Sponsors</a>
      <a href="#" class="mobile-menu-link" onclick="showPage('directory'); closeMobileMenu()">Shop Directory</a>
      <a href="#" class="mobile-menu-link admin-only" id="mobile-nav-admin"
        onclick="showPage('admin'); closeMobileMenu()" style="display: none;">ğŸ›¡ï¸ Admin</a>
      <a href="#" class="mobile-menu-link" onclick="openSupportChoiceModal(); closeMobileMenu()">ğŸ’¬ Contact Support</a>
      <a href="#" class="mobile-menu-link" onclick="openTermsModal(); closeMobileMenu()">âš–ï¸ Terms & Conditions</a>
      <a href="#" class="mobile-menu-link" onclick="openPrivacyModal(); closeMobileMenu()">ğŸ›¡ï¸ Privacy Policy</a>
    </div>
  </nav>


  <!-- Home Page (Dashboard) -->
  <main class="page active" id="page-home">
    <!-- Fishing Mode Toggle (Moved inside page container) -->
    <div class="fishing-mode-toggle-wrapper">
      <div class="fishing-mode-toggle" id="fishing-mode-toggle-container">
        <span class="mode-label active" id="mode-label-sea">ğŸŒŠ Sea</span>
        <label class="toggle-switch">
          <input type="checkbox" id="fishing-mode-toggle" onchange="toggleFishingMode()">
          <span class="toggle-slider"></span>
        </label>
        <span class="mode-label" id="mode-label-freshwater">ğŸï¸ Freshwater</span>

        <!-- Filter Button (moved here for sleeker UI) -->
        <button class="filter-toggle-btn-inline" id="filter-toggle-btn" onclick="toggleFilterPanel()"
          title="Show/Hide Map Layers">
          <span class="filter-toggle-icon">ğŸ—ºï¸</span>
          <span class="filter-toggle-text">Map Layers</span>
        </button>
      </div>
    </div>

    <!-- Sponsor Banner -->
    <div class="sponsor-banner-wrapper" id="sponsor-banner-wrapper" style="display: none;">
      <div class="sponsor-banner">
        <div class="sponsor-banner-track" id="sponsor-banner-track">
          <!-- Logos will be dynamically inserted here -->
        </div>
      </div>
    </div>

    <div class="app-container">
      <!-- Sidebar -->
      <aside class="sidebar">
        <!-- Location Info -->
        <div class="card fade-in" id="location-card">
          <div class="card-header">
            <span class="card-title">ğŸ“ Selected Location</span>
          </div>
          <div id="location-info">
            <div class="empty-state">
              <div class="empty-state-icon">ğŸ—ºï¸</div>
              <p>Select a tide station on the map</p>
            </div>
          </div>
        </div>

        <!-- Current Tide -->
        <div class="card fade-in" id="tide-card" style="display: none;">
          <div class="card-header">
            <span class="card-title">ğŸŒŠ Current Tide</span>
          </div>
          <div class="tide-current" id="tide-current">
            <div class="loading">
              <div class="loading-spinner"></div>
              <span>Loading tide data...</span>
            </div>
          </div>
        </div>

        <!-- Weather Conditions -->
        <div class="card fade-in" id="weather-card" style="display: none;">
          <div class="card-header" style="justify-content: space-between; display: flex; align-items: center;">
            <button class="nav-arrow" onclick="navigateForecast(-1)">â®</button>
            <span class="card-title" id="weather-card-title">Local Weather</span>
            <button class="nav-arrow" onclick="navigateForecast(1)">â¯</button>
          </div>
          <div class="weather-display" id="weather-display">
            <div class="loading">
              <div class="loading-spinner"></div>
              <span>Fetching weather...</span>
            </div>
          </div>
        </div>

        <!-- Ad Slot (Sidebar High) -->
        <div class="card fade-in ad-card" id="ad-card-sidebar">
          <div class="card-header">
            <span class="card-title">ğŸ“¢ ADS TO KEEP OUR PLATFORM FREE</span>
          </div>
          <div id="container-eebc42a1bc18608e22c241b4e8ae00ec"></div>
        </div>

        <!-- Today's Tides -->
        <div class="card fade-in" id="tide-times-card" style="display: none;">
          <div class="card-header" style="justify-content: space-between; display: flex; align-items: center;">
            <button class="nav-arrow" onclick="navigateForecast(-1)">â®</button>
            <span class="card-title" id="tide-card-title">Today's Tides</span>
            <button class="nav-arrow" onclick="navigateForecast(1)">â¯</button>
          </div>
          <div class="tide-times" id="tide-times">
            <!-- Populated by JS -->
          </div>
        </div>

        <!-- Fishing Conditions -->
        <div class="card fade-in" id="fishing-card" style="display: none;">
          <div class="card-header">
            <span class="card-title">ğŸ£ Fishing Conditions</span>
          </div>
          <div class="fishing-score" id="fishing-score">
            <!-- Populated by JS -->
          </div>
          <div class="moon-phase" id="moon-phase" style="margin-top: var(--space-md);">
            <!-- Populated by JS -->
          </div>
        </div>

        <!-- Nearby Shops -->
        <div class="card fade-in" id="shops-card" style="display: none;">
          <div class="card-header">
            <span class="card-title">ğŸ“ Nearby Fishing Shops</span>
          </div>
          <div class="shop-list" id="shop-list">
            <div class="loading">
              <div class="loading-spinner"></div>
              <span>Searching for shops...</span>
            </div>
          </div>
        </div>

        <!-- Tide Chart -->
        <div class="card fade-in" id="chart-card" style="display: none;">
          <div class="card-header">
            <span class="card-title">ğŸ“ˆ Tide Chart (24h)</span>
          </div>
          <div class="chart-container">
            <canvas id="tide-chart"></canvas>
          </div>
        </div>

        <!-- Station List -->
        <div class="card">
          <div class="card-header">
            <span class="card-title">ğŸ“‹ All Stations</span>
          </div>
          <div class="station-list" id="station-list">
            <div class="loading">
              <div class="loading-spinner"></div>
              <span>Loading stations...</span>
            </div>
          </div>
        </div>

        <div class="sidebar-footer">
          <a href="#" onclick="openSupportChoiceModal()">Contact Support</a>
          <span>â€¢</span>
          <a href="#" onclick="openTermsModal()">Terms & Conditions</a>
          <span>â€¢</span>
          <a href="#" onclick="openPrivacyModal()">Privacy Policy</a>
          <span>&copy; 2026 Irish Fishing Hub</span>
        </div>
      </aside>

      <!-- Map -->
      <section class="map-container">

        <!-- Collapsible Filter Panel -->
        <div class="filter-sidebar" id="filter-sidebar">
          <div class="filter-sidebar-header">
            <h3>Map Filters</h3>
            <button class="filter-close-btn" onclick="applyAndCloseFilters()">&times;</button>
          </div>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" id="filter-stations" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸŒŠ</span> Tidal Stations
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-shops" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸª</span> Tackle Shops
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-piers" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸ£</span> Fishing Piers
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-ramps" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸš¤</span> Boat Ramps
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-harbours" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸ›¥ï¸</span> Harbours
            </label>
          </div>
          <button class="filter-apply-btn" onclick="applyFilters()">âœ“ Apply Filters</button>
        </div>

        <!-- Filter Overlay -->
        <div class="filter-overlay" id="filter-overlay" onclick="closeFilterPanel()"></div>

        <!-- Freshwater Filter Sidebar (hidden in sea mode) -->
        <div class="filter-sidebar freshwater-filter-sidebar" id="freshwater-filter-sidebar" style="display: none;">
          <div class="filter-sidebar-header">
            <h3>ğŸï¸ Freshwater Filters</h3>
            <button class="filter-close-btn" onclick="applyFreshwaterFilters()">&times;</button>
          </div>
          <div class="filter-options">
            <label class="filter-option">
              <input type="checkbox" id="filter-fw-spots" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸŸ</span> Fishing Spots
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-fw-parks" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸï¸</span> Fishing Parks
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-fw-ramps" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸš¤</span> Boat Ramps
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-fw-piers" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸ£</span> Piers & Platforms
            </label>
            <label class="filter-option">
              <input type="checkbox" id="filter-fw-shops" checked>
              <span class="filter-checkbox"></span>
              <span class="filter-emoji">ğŸª</span> Tackle Shops
            </label>
          </div>
          <button class="filter-apply-btn" onclick="applyFreshwaterFilters()">âœ“ Apply Filters</button>
        </div>

        <!-- Freshwater Filter Overlay -->
        <div class="filter-overlay" id="freshwater-filter-overlay" onclick="closeFreshwaterFilterPanel()"></div>

        <div id="map"></div>
      </section>
    </div>
  </main>

  <!-- Community Page (Social) -->
  <main class="page" id="page-community" style="display: none;">
    <div class="app-container">
      <aside class="sidebar">
        <div class="card">
          <div class="card-header" style="justify-content: space-between; display: flex; align-items: center;">
            <span class="card-title">ğŸ“¸ Pin a spot on the map or post an update</span>
            <button class="btn btn-sm btn-primary" onclick="openPostModal(null)">ğŸ“ Post Update</button>
          </div>
          <div class="catch-feed" id="catch-feed">
            <div class="empty-state">
              <p>No catches shared yet. Be the first!</p>
            </div>
          </div>
        </div>
        <div class="sidebar-footer">
          <a href="#" onclick="openSupportChoiceModal()">Contact Support</a>
          <span>â€¢</span>
          <a href="#" onclick="openTermsModal()">Terms & Conditions</a>
          <span>â€¢</span>
          <a href="#" onclick="openPrivacyModal()">Privacy Policy</a>
          <span>&copy; 2026 Irish Fishing Hub</span>
        </div>
      </aside>
      <section class="map-container">
        <div id="community-gating-overlay" class="premium-overlay" style="display: none;">
          <div class="overlay-content" id="community-login-prompt">
            <div class="premium-badge">ğŸ”’ LOGIN REQUIRED</div>
            <h2>Create a Free Account</h2>
            <p>The Community Hub is available to all registered users. Create a free account to share catches, interact
              with other anglers, and access all features!</p>
            <button class="btn btn-primary btn-lg" onclick="openAuthModal()">Sign Up / Login</button>
            <p class="premium-footer">Join the Irish fishing community today ğŸ£</p>
          </div>
          <div class="overlay-content" id="community-premium-prompt" style="display: none;">
            <div class="premium-badge">ğŸ† PREMIUM</div>
            <h2>Join the Crew!</h2>
            <p>The Community Hub is exclusive to Pro members. See live catches, share your own spots, and interact with
              other anglers across Ireland.</p>
            <div class="premium-price">Only â‚¬10 / month</div>
            <button class="btn btn-primary btn-lg" onclick="openPremiumModal()">Upgrade to Pro</button>
            <p class="premium-footer">Join 500+ pros on the water today ğŸ£</p>
          </div>
        </div>
        <div id="social-map"></div>
        <div class="map-overlay">
          <p>Click anywhere on the map to mark a new fishing spot!</p>
        </div>
      </section>
    </div>
  </main>

  <!-- Sponsors Page -->
  <main class="page" id="page-sponsors" style="display: none;">
    <div class="directory-container">
      <div class="directory-hero">
        <h1>ğŸ¤ Our Sponsors</h1>
        <p>Supporting the Irish Fishing Hub community</p>
      </div>

      <div class="sponsors-grid" id="sponsors-grid">
        <div class="empty-state">
          <p>No sponsors yet. Check back soon!</p>
        </div>
      </div>
    </div>
  </main>

  <!-- Directory Page (National Shop List) -->
  <main class="page" id="page-directory" style="display: none;">
    <div class="directory-container">
      <div class="directory-hero">
        <h1>ğŸ‡®ğŸ‡ª National Tackle Store Directory</h1>
        <p>Find the best fishing gear across every county in Ireland</p>
      </div>
      <div class="county-directory" id="county-directory">
        <div class="loading">
          <div class="loading-spinner"></div>
          <span>Loading national directory...</span>
        </div>
      </div>
    </div>
  </main>

  <!-- Custom Catch Modal -->
  <div id="catch-modal" class="modal">
    <div class="modal-content">
      <h3>ğŸ£ Share Your Catch</h3>
      <div class="form-group">
        <label>What did you catch?</label>
        <input type="text" id="catch-species" placeholder="e.g., Sea Bass, Mackerel">
      </div>
      <div class="form-group">
        <label>Details</label>
        <textarea id="catch-details" placeholder="How was the fight? What bait did you use?"></textarea>
      </div>
      <div class="form-group">
        <label>Add a Photo</label>
        <div class="file-input-wrapper">
          <input type="file" id="catch-photo" accept="image/*" onchange="previewImage(this)">
          <div id="image-preview" class="image-preview" style="display: none;">
            <img id="preview-img" src="" alt="Preview">
            <button class="remove-image" onclick="removeImage()">âœ•</button>
          </div>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn" onclick="closeModal()">Cancel</button>
        <button class="btn btn-primary" onclick="submitCatch()">Post Spot</button>
      </div>
    </div>
  </div>



  <!-- Auth Modal -->
  <div class="modal" id="auth-modal">
    <div class="modal-content">
      <h2 id="auth-title">Welcome Back</h2>
      <p id="auth-sub">Log in to your account</p>
      <div class="auth-form-container">
        <input type="email" id="auth-email" placeholder="Email Address" class="auth-input">
        <input type="text" id="auth-username" placeholder="Username (Signup Only)" class="auth-input"
          style="display: none;">
        <div style="position: relative;">
          <input type="password" id="auth-password" placeholder="Password" class="auth-input">
          <button type="button" onclick="togglePasswordVisibility()"
            style="position: absolute; right: 12px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 1.2rem; color: var(--text-secondary); padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;"
            title="Show/Hide Password" id="password-toggle-btn">
            ğŸ‘ï¸
          </button>
        </div>
        <label class="auth-remember"
          style="display:flex; align-items:center; gap:8px; margin: 10px 0; font-size: 0.9rem; cursor: pointer;">
          <input type="checkbox" id="auth-remember" checked>
          <span>Remember me</span>
        </label>
        <button class="btn btn-primary"
          onclick="handleAuthSubmit(); setTimeout(refreshCommunityGating, 100);">Continue</button>
        <p class="auth-switch">Don't have an account? <a href="#" onclick="toggleAuthMode()">Sign up</a></p>
      </div>
      <button class="modal-close-btn" onclick="closeAuthModal()">âœ•</button>
    </div>
  </div>

  <!-- Premium Upgrade Modal -->
  <div class="modal" id="premium-modal">
    <div class="modal-content modal-large">
      <div class="premium-modal-grid">
        <div class="premium-modal-info">
          <div class="premium-badge">ğŸ† PRO PLAN</div>
          <h2>Unlock the Hub</h2>
          <ul class="premium-benefits">
            <li>âœ… Post catches to the Community Feed</li>
            <li>âœ… Detailed catch coordinates & spots</li>
            <li>âœ… Like & Comment on others posts</li>
            <li>âœ… Exclusive pro angler insights</li>
            <li>âœ… Support the development of Irish Fishing Hub</li>
          </ul>
        </div>
        <div class="premium-modal-cta">
          <div class="price-bubble">
            <span class="currency">â‚¬</span><span class="amount">10</span><span class="freq">/mo</span>
          </div>
          <p>Cancel any time. No contracts.</p>
          <button class="btn btn-success btn-lg" onclick="openStripeCheckout()">Start Pro Membership</button>
          <div class="stripe-badge-container">
            <svg class="stripe-svg" viewBox="0 0 60 25" xmlns="http://www.w3.org/2000/svg">
              <path fill="currentColor"
                d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.27 2.55 1.63 0 2.91-.44 3.82-1l.73 2.15c-1.12.77-2.85 1.34-4.88 1.34-3.51 0-5.73-2.22-5.73-6.24 0-3.66 2.04-6.3 5.42-6.3 3.32 0 5.14 2.51 5.14 5.74 0 .42-.03.82-.07 1.05.01-.15.01-.15.36-.29zm-7.98-2.15h5.1c-.13-1.63-1.42-2.3-2.52-2.3-1.39 0-2.34.84-2.58 2.3zM45.72 8.28c-1.36 0-2.23.63-2.73 1.25V8.5h-2.8v13.52c0 .28-.01.55.02.82l2.8-.2v-6.35c.57.57 1.41 1.01 2.52 1.01 2.36 0 4.38-2.11 4.38-5.51 0-3.48-2.01-5.51-4.19-5.51zm-.81 5.4c-1.07 0-1.74-.63-1.92-1.06v-2.09c.18-.43.85-1.06 1.92-1.06 1.15 0 1.65 1.08 1.65 2.11 0 1.02-.5 2.1-1.65 2.1zM34.78 6.55c-1.11 0-2.07.45-2.61.94V3.13l-3.04.64v13.52c0 .28-.01.55.02.82l2.8-.2V9.92c.51-.55 1.38-1.08 2.3-1.08.66 0 .97.31.97.99V18.1c0 .28-.01.55.02.82l2.8-.2v-9.5c.01-1.57-.96-2.67-3.26-2.67zM24.78 18.25l-.01.1L24.78 19.1c.21 0 .28-.01.28-.31V8.5h-2.8v1.3c-.53-.8-1.47-1.52-3.04-1.52-2.45 0-4.59 2.18-4.59 5.51 0 3.33 2.14 5.51 4.59 5.51 1.57 0 2.51-.72 3.04-1.52v.87c.01 0-.01.01-.1.1zM19.46 13.68c0-1.03.5-2.11 1.65-2.11 1.07 0 1.74.63 1.92 1.06v2.09c-.18.43-.85 1.06-1.92 1.06-1.15 0-1.65-1.08-1.65-2.11zM11.66 4.3c-.22 0-.46.03-.7.09l.48 2.6c.15-.04.31-.06.39-.06.74 0 1.19.43 1.19 1.19v.42H10.1v2.73h2.92v6.83c0 .28-.01.55.02.82l2.8-.2V11.27h1.99V8.54h-1.99V7.93c0-2.31-1.13-3.63-4.18-3.63zM1.02 11.27l1.37.58c1.39.59 2.05 1 2.05 1.98 0 .86-.71 1.33-1.89 1.33-1.51 0-3.13-.57-4.22-1.28L-2 16.51c1.36.85 3.35 1.51 5.37 1.51 3.55 0 5.4-1.74 5.4-4.29 0-3.37-2.32-4.11-4.73-5.11l-1.37-.58c-.97-.41-1.64-.78-1.64-1.51 0-.61.54-1.02 1.52-1.02 1.2 0 2.56.45 3.51.98l1.01-2.52C5.74 3.06 4.19 2.5 2.6 2.5.01 2.5-2.1 3.99-2.1 6.51c0 3.05 2.14 3.93 4.49 4.91z" />
            </svg>
            <span class="stripe-secure-text">Secure 256-bit SSL encrypted payment</span>
          </div>
        </div>
      </div>
      <button class="modal-close-btn" onclick="closePremiumModal()">âœ•</button>
    </div>
  </div>

  <!-- Stripe Checkout Modal -->
  <div class="modal" id="stripe-checkout-modal">
    <div class="modal-content stripe-checkout-container">
      <div class="stripe-header">
        <div class="stripe-logo">
          <svg viewBox="0 0 60 25" xmlns="http://www.w3.org/2000/svg">
            <path fill="currentColor"
              d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.27 2.55 1.63 0 2.91-.44 3.82-1l.73 2.15c-1.12.77-2.85 1.34-4.88 1.34-3.51 0-5.73-2.22-5.73-6.24 0-3.66 2.04-6.3 5.42-6.3 3.32 0 5.14 2.51 5.14 5.74 0 .42-.03.82-.07 1.05.01-.15.01-.15.36-.29zm-7.98-2.15h5.1c-.13-1.63-1.42-2.3-2.52-2.3-1.39 0-2.34.84-2.58 2.3zM45.72 8.28c-1.36 0-2.23.63-2.73 1.25V8.5h-2.8v13.52c0 .28-.01.55.02.82l2.8-.2v-6.35c.57.57 1.41 1.01 2.52 1.01 2.36 0 4.38-2.11 4.38-5.51 0-3.48-2.01-5.51-4.19-5.51zm-.81 5.4c-1.07 0-1.74-.63-1.92-1.06v-2.09c.18-.43.85-1.06 1.92-1.06 1.15 0 1.65 1.08 1.65 2.11 0 1.02-.5 2.1-1.65 2.1zM34.78 6.55c-1.11 0-2.07.45-2.61.94V3.13l-3.04.64v13.52c0 .28-.01.55.02.82l2.8-.2V9.92c.51-.55 1.38-1.08 2.3-1.08.66 0 .97.31.97.99V18.1c0 .28-.01.55.02.82l2.8-.2v-9.5c.01-1.57-.96-2.67-3.26-2.67zM24.78 18.25l-.01.1L24.78 19.1c.21 0 .28-.01.28-.31V8.5h-2.8v1.3c-.53-.8-1.47-1.52-3.04-1.52-2.45 0-4.59 2.18-4.59 5.51 0 3.33 2.14 5.51 4.59 5.51 1.57 0 2.51-.72 3.04-1.52v.87c.01 0-.01.01-.1.1zM19.46 13.68c0-1.03.5-2.11 1.65-2.11 1.07 0 1.74.63 1.92 1.06v2.09c-.18.43-.85 1.06-1.92 1.06-1.15 0-1.65-1.08-1.65-2.11zM11.66 4.3c-.22 0-.46.03-.7.09l.48 2.6c.15-.04.31-.06.39-.06.74 0 1.19.43 1.19 1.19v.42H10.1v2.73h2.92v6.83c0 .28-.01.55.02.82l2.8-.2V11.27h1.99V8.54h-1.99V7.93c0-2.31-1.13-3.63-4.18-3.63zM1.02 11.27l1.37.58c1.39.59 2.05 1 2.05 1.98 0 .86-.71 1.33-1.89 1.33-1.51 0-3.13-.57-4.22-1.28L-2 16.51c1.36.85 3.35 1.51 5.37 1.51 3.55 0 5.4-1.74 5.4-4.29 0-3.37-2.32-4.11-4.73-5.11l-1.37-.58c-.97-.41-1.64-.78-1.64-1.51 0-.61.54-1.02 1.52-1.02 1.2 0 2.56.45 3.51.98l1.01-2.52C5.74 3.06 4.19 2.5 2.6 2.5.01 2.5-2.1 3.99-2.1 6.51c0 3.05 2.14 3.93 4.49 4.91z" />
          </svg>
        </div>
        <button class="modal-close-btn-inline" onclick="closeStripeCheckout()">âœ•</button>
      </div>

      <div class="stripe-body">
        <div class="checkout-summary">
          <p class="product-name">Irish Fishing Hub Pro</p>
          <div class="product-price">â‚¬10.00 <span class="price-period">per month</span></div>
        </div>

        <div class="stripe-form">
          <div class="form-group stripe-field">
            <label>Card Information</label>
            <div class="card-input-container">
              <input type="text" id="stripe-card-number" placeholder="1234 5678 1234 5678" maxlength="19">
              <div class="card-meta">
                <input type="text" id="stripe-card-expiry" placeholder="MM / YY" maxlength="7">
                <input type="text" id="stripe-card-cvc" placeholder="CVC" maxlength="3">
              </div>
            </div>
          </div>

          <div class="form-group stripe-field">
            <label>Cardholder Name</label>
            <input type="text" id="stripe-card-name" placeholder="John Doe">
          </div>

          <div class="form-group stripe-field">
            <label>Country or region</label>
            <select id="stripe-country">
              <option value="IE">Ireland</option>
              <option value="UK">United Kingdom</option>
              <option value="US">United States</option>
            </select>
          </div>

          <button class="stripe-pay-btn" id="stripe-pay-btn" onclick="processStripePayment()">
            <span class="btn-text">Subscribe</span>
            <div class="stripe-spinner hidden" id="stripe-pay-spinner"></div>
          </button>

          <p class="stripe-disclaimer">By confirming your subscription, you allow Irish Fishing Hub to charge your card
            for this payment and future payments in accordance with their terms.</p>
        </div>
      </div>

      <div class="stripe-footer">
        <span class="powered-by">Powered by <strong>Stripe</strong></span>
        <div class="footer-links">
          <span>Terms</span>
          <span>Privacy</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Shop Details Modal -->
  <div class="modal" id="shop-details-modal">
    <div class="modal-content modal-large">
      <div id="shop-details-hero" class="street-view-container">
        <div class="loading-overlay" id="sv-loading">
          <div class="loading-spinner"></div>
        </div>
        <img id="street-view-image" src="" alt="Shop Exterior" style="display: none;"
          onload="this.style.display='block'; document.getElementById('sv-loading').style.display='none';">
        <div class="no-image-placeholder" id="sv-fallback" style="display: none;">
          <span>ğŸ™ï¸ No street view available</span>
        </div>
      </div>

      <div class="shop-details-body">
        <h2 id="shop-details-name">Shop Name</h2>
        <div class="shop-meta-large">
          <p id="shop-details-address"><span class="icon">ğŸ“</span> Loading address...</p>
          <p id="shop-details-phone"><span class="icon">ğŸ“</span> Loading phone...</p>
          <p id="shop-details-email"><span class="icon">ğŸ“§</span> Loading email...</p>
        </div>

        <div class="modal-actions">
          <button class="btn" onclick="closeShopDetails()">Close</button>
          <button id="shop-details-directions-btn" class="btn btn-primary">Get Directions</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Profile Modal -->
  <div class="modal" id="profile-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ‘¤ Your Profile</h2>
        <button class="modal-close-btn-inline" onclick="closeProfileModal()">âœ•</button>
      </div>

      <div class="profile-header-section">
        <div class="avatar-upload-wrapper">
          <img id="profile-avatar-preview" src="" alt="Profile">
          <label for="avatar-input" class="avatar-edit-btn">ğŸ“·</label>
          <input type="file" id="avatar-input" accept="image/*" style="display: none;"
            onchange="handleAvatarSelect(this)">
        </div>
        <div class="profile-status">
          <span id="profile-plan-badge" class="plan-badge">FREE PLAN</span>
          <button class="btn btn-sm btn-outline" id="profile-upgrade-btn" onclick="openPremiumModal()">Upgrade</button>
        </div>
      </div>

      <div class="form-group">
        <label>Display Name</label>
        <input type="text" id="profile-name" class="auth-input">
      </div>

      <div class="form-group">
        <label>Bio</label>
        <textarea id="profile-bio" class="auth-input" rows="3"
          placeholder="Tell us about your fishing experience..."></textarea>
      </div>

      <div class="modal-actions" style="justify-content: space-between; margin-top: 20px;">
        <button class="btn btn-danger btn-outline" onclick="logout()">Log Out</button>
        <div style="display: flex; gap: 10px;">
          <button class="btn btn-outline" onclick="openSupportModal()">ğŸ’¬ Contact Support</button>
          <button class="btn btn-primary" onclick="saveProfile()">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Sponsor Modal -->
  <div class="modal" id="sponsor-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="sponsor-modal-title">â• Add New Sponsor</h2>
        <button class="modal-close-btn-inline" onclick="closeSponsorModal()">âœ•</button>
      </div>

      <div class="form-group">
        <label>Sponsor Name *</label>
        <input type="text" id="sponsor-name-input" class="auth-input" placeholder="e.g. Fishing Tackle Ireland">
      </div>

      <div class="form-group">
        <label>Logo URL *</label>
        <input type="url" id="sponsor-logo-url" class="auth-input" placeholder="https://example.com/logo.png">
        <small style="color: var(--text-muted); font-size: 0.85rem;">Paste a direct link to the sponsor's logo
          image</small>
      </div>

      <div class="form-group">
        <label>Email</label>
        <input type="email" id="sponsor-email-input" class="auth-input" placeholder="contact@sponsor.com">
      </div>

      <div class="form-group">
        <label>Phone</label>
        <input type="tel" id="sponsor-phone-input" class="auth-input" placeholder="+353 1 234 5678">
      </div>

      <div class="form-group">
        <label>Website URL</label>
        <input type="url" id="sponsor-website-input" class="auth-input" placeholder="https://sponsor-website.com">
      </div>

      <div class="form-group">
        <label>Description (Optional)</label>
        <textarea id="sponsor-description-input" class="auth-input" rows="3"
          placeholder="Brief description of the sponsor..."></textarea>
      </div>

      <div class="modal-actions" style="margin-top: 20px;">
        <button class="btn btn-outline" onclick="closeSponsorModal()">Cancel</button>
        <button class="btn btn-primary" onclick="saveSponsor()" id="save-sponsor-btn">Add Sponsor</button>
      </div>
    </div>
  </div>

  <!-- Sponsor Info Modal -->
  <div class="modal" id="sponsor-info-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="sponsor-info-title">Sponsor Information</h2>
        <button class="modal-close-btn-inline" onclick="closeSponsorInfoModal()">âœ•</button>
      </div>

      <div class="sponsor-info-content">
        <div class="sponsor-info-logo-wrapper">
          <img id="sponsor-info-logo" src="" alt="Sponsor Logo" class="sponsor-info-logo">
        </div>

        <h3 id="sponsor-info-name" class="sponsor-info-name"></h3>

        <div id="sponsor-info-description" class="sponsor-info-description" style="display: none;"></div>

        <div class="sponsor-info-contacts">
          <div class="sponsor-contact-item" id="sponsor-contact-email" style="display: none;">
            <span class="contact-icon">ğŸ“§</span>
            <a id="sponsor-email-link" href="" class="contact-link"></a>
          </div>

          <div class="sponsor-contact-item" id="sponsor-contact-phone" style="display: none;">
            <span class="contact-icon">ğŸ“</span>
            <a id="sponsor-phone-link" href="" class="contact-link"></a>
          </div>

          <div class="sponsor-contact-item">
            <span class="contact-icon">ğŸŒ</span>
            <a id="sponsor-website-link" href="" target="_blank" rel="noopener noreferrer" class="contact-link"></a>
          </div>
        </div>
      </div>

      <div class="modal-actions" style="margin-top: 20px;">
        <button class="btn btn-primary" onclick="visitSponsorWebsite()" id="visit-sponsor-btn">Visit Website â†’</button>
      </div>
    </div>
  </div>

  <!-- Admin Dashboard Page -->
  <main class="page" id="page-admin" style="display: none;">
    <div class="admin-container">
      <div class="admin-header">
        <h1>ğŸ›¡ï¸ Admin Dashboard</h1>
        <p>Manage users, view insights, and respond to support messages</p>
      </div>

      <div class="admin-grid">
        <!-- Station Insights -->
        <div class="admin-card">
          <div class="admin-card-header">
            <h3>ğŸ“Š Tidal Station Insights</h3>
          </div>
          <div class="admin-card-body admin-card-body-flush" id="admin-station-insights">
            <div class="insight-grid">
              <div class="insight-item">
                <span class="insight-value" id="total-stations">0</span>
                <span class="insight-label">Total Stations</span>
              </div>
              <div class="insight-item">
                <span class="insight-value" id="active-stations">0</span>
                <span class="insight-label">Active</span>
              </div>
              <div class="insight-item">
                <span class="insight-value" id="offline-stations">0</span>
                <span class="insight-label">Offline</span>
              </div>
            </div>
            <div class="station-status-list" id="admin-station-list">
              <!-- Populated by JS -->
            </div>
          </div>
        </div>

        <!-- Communication Center (Email) -->
        <div class="admin-card admin-card-full" id="admin-email-center" style="display: none;">
          <div class="admin-card-header">
            <h3>ğŸ“¨ Communication Center</h3>
            <button class="btn btn-sm btn-outline" onclick="closeEmailCenter()">Close</button>
          </div>
          <div class="admin-card-body">
            <div class="broadcast-stats">
              <div class="stat-box">
                <span class="label">Audience</span>
                <span class="val" id="email-total-members">0 Members</span>
              </div>
              <div class="stat-box">
                <span class="label">Last Sent</span>
                <span class="val" id="email-last-sent">N/A</span>
              </div>
            </div>

            <div class="email-center-grid">
              <div class="template-selector">
                <button class="template-btn active" id="btn-temp-update" onclick="loadEmailTemplate('update')">
                  <span class="temp-name">ğŸš€ App Update</span>
                  <span class="temp-desc">New features & improvements</span>
                </button>
                <button class="template-btn" id="btn-temp-legal" onclick="loadEmailTemplate('legal')">
                  <span class="temp-name">âš–ï¸ Legal Change</span>
                  <span class="temp-desc">Policy & Terms updates</span>
                </button>
                <button class="template-btn" id="btn-temp-welcome" onclick="loadEmailTemplate('welcome')">
                  <span class="temp-name">ğŸ‘‹ Welcome</span>
                  <span class="temp-desc">Greeting for new members</span>
                </button>
                <button class="template-btn" id="btn-temp-custom" onclick="loadEmailTemplate('custom')">
                  <span class="temp-name">âœï¸ Custom Message</span>
                  <span class="temp-desc">Write from scratch</span>
                </button>
              </div>

              <div class="email-editor-panel">
                <input type="text" id="email-subject" class="email-subject-input" placeholder="Email Subject">
                <textarea id="email-body" class="email-body-editor" placeholder="Write your message here..."></textarea>

                <div class="email-footer-actions">
                  <span id="email-status-text" style="font-size: 0.85rem; color: var(--text-muted);"></span>
                  <button class="btn btn-outline" onclick="testEmailPreview()">Preview</button>
                  <button class="btn btn-primary" onclick="broadcastEmailToAll()">ğŸš€ Send to All members</button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- User Accounts -->
        <div class="admin-card">
          <div class="admin-card-header" style="justify-content: space-between;">
            <div style="display: flex; align-items: center; gap: 15px;">
              <h3>ğŸ‘¥ User Accounts</h3>
              <div class="admin-search-wrapper" id="admin-search-container">
                <button class="admin-search-toggle" onclick="toggleAdminSearch()" title="Toggle Search">ğŸ”</button>
                <input type="text" id="admin-user-search" placeholder="Search accounts..."
                  class="admin-search-input-collapsible" oninput="loadUsersTable()">
              </div>
            </div>
            <div style="display: flex; align-items: center; gap: 10px;">
              <button class="btn btn-sm btn-primary" onclick="openEmailCenter()">ğŸ“¨ Global Broadcast</button>
              <span class="badge" id="total-users-badge">0 users</span>
            </div>
          </div>
          <div class="admin-card-body admin-card-body-flush">
            <div class="admin-table-scroll-wrapper">
              <table class="admin-table" id="users-table">
                <thead>
                  <tr>
                    <th>Name</th>
                    <th>Email</th>
                    <th>Password</th>
                    <th>Plan</th>
                    <th>Joined</th>
                    <th>Status</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="users-table-body">
                  <!-- Populated by JS -->
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Support Messages -->
        <div class="admin-card admin-card-full">
          <div class="admin-card-header">
            <h3>ğŸ’¬ Support Messages</h3>
            <span class="badge" id="unread-messages-badge">0 unread</span>
          </div>
          <div class="admin-card-body">
            <div class="messages-list" id="admin-messages-list">
              <div class="empty-state">
                <p>No support messages yet</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Reported Community Content -->
        <div class="admin-card admin-card-full">
          <div class="admin-card-header">
            <h3>âš ï¸ Reported Community Content</h3>
            <div class="report-filters">
              <button class="btn btn-sm btn-primary" onclick="filterReports('pending')">Pending</button>
              <button class="btn btn-sm btn-outline" onclick="filterReports('dismissed')">Dismissed</button>
              <button class="btn btn-sm btn-outline" onclick="filterReports('removed')">Removed</button>
              <button class="btn btn-sm btn-outline" onclick="filterReports('all')">All</button>
            </div>
          </div>
          <div class="admin-card-body">
            <div id="reported-comments-list">
              <div class="empty-state">
                <p>Loading reports...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Sponsor Management -->
        <div class="admin-card admin-card-full">
          <div class="admin-card-header">
            <h3>ğŸ¤ Sponsor Management</h3>
            <button class="btn btn-sm btn-primary" onclick="openAddSponsorModal()">â• Add New Sponsor</button>
          </div>
          <div class="admin-card-body">
            <div class="admin-table-scroll-wrapper">
              <table class="sponsor-table">
                <thead>
                  <tr>
                    <th>Logo</th>
                    <th>Name</th>
                    <th>Website</th>
                    <th>Added</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody id="sponsors-table-body">
                  <tr>
                    <td colspan="5" class="empty-state">
                      <p>No sponsors yet. Click "Add New Sponsor" to get started.</p>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Location Manager -->
        <div class="admin-card admin-card-full">
          <div class="admin-card-header">
            <h3>ğŸ“ Location Manager</h3>
            <div class="admin-location-controls">
              <div class="mode-toggle-admin">
                <button class="mode-btn active" id="admin-mode-sea" onclick="setAdminMapMode('sea')">ğŸŒŠ Sea</button>
                <button class="mode-btn" id="admin-mode-freshwater" onclick="setAdminMapMode('freshwater')">ğŸï¸
                  Freshwater</button>
              </div>
              <select id="admin-location-type" class="admin-select">
                <option value="pier">ğŸ£ Pier</option>
                <option value="ramp">ğŸš¤ Boat Ramp</option>
                <option value="harbour">ğŸ›¥ï¸ Harbour</option>
                <option value="spot">ğŸŸ Fishing Spot</option>
                <option value="park">ğŸŒ² Park</option>
                <option value="shop">ğŸª Tackle Shop</option>
              </select>
              <button class="btn btn-primary btn-sm" id="add-location-btn" onclick="enableAddLocationMode()">
                â• Add Location
              </button>
            </div>
          </div>
          <div class="admin-card-body admin-map-body">
            <div class="admin-map-container">
              <div id="admin-map"></div>
              <div class="admin-map-instructions" id="admin-map-instructions" style="display: none;">
                Click on the map to place a new location
              </div>
            </div>
            <div class="admin-location-list">
              <h4>Locations <span id="admin-location-count">(0)</span></h4>
              <div class="location-list-items" id="admin-location-list">
                <!-- Populated by JS -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Location Editor Modal -->
  <div class="modal" id="location-editor-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="location-editor-title">Add Location</h2>
        <button class="modal-close-btn-inline" onclick="closeLocationEditor()">âœ•</button>
      </div>
      <form id="location-editor-form" onsubmit="saveLocation(event)">
        <input type="hidden" id="location-id">
        <input type="hidden" id="location-mode">
        <div class="form-group">
          <label for="location-name">Name *</label>
          <input type="text" id="location-name" required placeholder="Enter location name">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="location-lat">Latitude *</label>
            <input type="number" id="location-lat" required step="0.0001" placeholder="53.3478">
          </div>
          <div class="form-group">
            <label for="location-lon">Longitude *</label>
            <input type="number" id="location-lon" required step="0.0001" placeholder="-6.2044">
          </div>
        </div>
        <div class="form-group">
          <label for="location-type-edit">Type *</label>
          <select id="location-type-edit" required>
            <option value="pier">ğŸ£ Pier</option>
            <option value="ramp">ğŸš¤ Boat Ramp</option>
            <option value="harbour">ğŸ›¥ï¸ Harbour</option>
            <option value="spot">ğŸŸ Fishing Spot</option>
            <option value="park">ğŸŒ² Park</option>
            <option value="shop">ğŸª Tackle Shop</option>
          </select>
        </div>
        <div class="form-group">
          <label for="location-description">Description</label>
          <textarea id="location-description" rows="2" placeholder="Optional description"></textarea>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-outline" onclick="closeLocationEditor()">Cancel</button>
          <button type="button" class="btn btn-danger" id="delete-location-btn" onclick="deleteLocation()"
            style="display: none;">Delete</button>
          <button type="submit" class="btn btn-primary">Save Location</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Shop Editor Modal -->
  <div class="modal" id="shop-editor-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="shop-editor-title">Add Shop</h2>
        <button class="modal-close-btn-inline" onclick="closeShopEditor()">âœ•</button>
      </div>
      <form id="shop-editor-form" onsubmit="saveShop(event)">
        <input type="hidden" id="shop-id">
        <input type="hidden" id="shop-mode">
        <div class="form-group">
          <label for="shop-name">Shop Name *</label>
          <input type="text" id="shop-name" required placeholder="e.g., Rory's Fishing Tackle">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="shop-county">County *</label>
            <input type="text" id="shop-county" required placeholder="e.g., Dublin">
          </div>
          <div class="form-group">
            <label for="shop-rating">Rating</label>
            <input type="number" id="shop-rating" step="0.1" min="0" max="5" placeholder="4.5">
          </div>
        </div>
        <div class="form-group">
          <label for="shop-address">Address</label>
          <input type="text" id="shop-address" placeholder="Full street address">
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="shop-phone">Phone</label>
            <input type="tel" id="shop-phone" placeholder="01 234 5678">
          </div>
          <div class="form-group">
            <label for="shop-website">Website</label>
            <input type="url" id="shop-website" placeholder="https://example.com">
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="shop-lat">Latitude *</label>
            <input type="number" id="shop-lat" required step="0.0001" placeholder="53.3478">
          </div>
          <div class="form-group">
            <label for="shop-lon">Longitude *</label>
            <input type="number" id="shop-lon" required step="0.0001" placeholder="-6.2044">
          </div>
        </div>
        <div class="form-actions">
          <button type="button" class="btn btn-outline" onclick="closeShopEditor()">Cancel</button>
          <button type="button" class="btn btn-danger" id="delete-shop-btn" onclick="deleteShop()"
            style="display: none;">Delete</button>
          <button type="submit" class="btn btn-primary">Save Shop</button>
        </div>
      </form>
    </div>
  </div>


  <!-- Contact Support Modal -->
  <div class="modal" id="support-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ’¬ Contact Support</h2>
        <button class="modal-close-btn-inline" onclick="closeSupportModal()">âœ•</button>
      </div>

      <div class="support-thread" id="support-thread">
        <div class="empty-state">
          <p>No messages yet. Send us a message below!</p>
        </div>
      </div>

      <div class="support-compose">
        <textarea id="support-message-input" placeholder="Type your message here..." rows="3"></textarea>
        <button class="btn btn-primary" onclick="sendSupportMessage()">Send Message</button>
      </div>
    </div>
  </div>

  <!-- Public User Profile Modal -->
  <div class="modal" id="public-profile-modal">
    <div class="modal-content profile-modal-content">
      <div class="modal-header">
        <h2>ğŸ‘¤ User Profile</h2>
        <button class="modal-close-btn-inline" onclick="closePublicProfileModal()">âœ•</button>
      </div>
      <div class="public-profile-view">
        <div class="profile-avatar-large" id="public-profile-avatar">ğŸ‘¤</div>
        <h3 id="public-profile-name">User Name</h3>
        <span class="badge" id="public-profile-badge">Pro Angler</span>
        <p class="profile-bio" id="public-profile-bio">No bio available.</p>
        <div class="profile-stats-row">
          <div class="profile-stat">
            <span class="stat-value" id="public-profile-joined">-</span>
            <span class="stat-label">Joined</span>
          </div>
          <div class="profile-stat">
            <span class="stat-value" id="public-profile-catches">0</span>
            <span class="stat-label">Catches</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Reply Modal -->
  <div class="modal" id="admin-reply-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ“© Reply to <span id="reply-to-user">User</span></h2>
        <button class="modal-close-btn-inline" onclick="closeAdminReplyModal()">âœ•</button>
      </div>

      <div class="support-thread" id="admin-reply-thread">
        <!-- Shows conversation history -->
      </div>

      <div class="support-compose">
        <textarea id="admin-reply-input" placeholder="Type your reply..." rows="3"></textarea>
        <button class="btn btn-primary" onclick="sendAdminReply()">Send Reply</button>
      </div>
    </div>
  </div>

  <!-- Username Editor Modal (Admin) -->
  <div class="modal" id="username-editor-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>âœï¸ Edit Username</h2>
        <button class="modal-close-btn-inline" onclick="closeUsernameEditor()">âœ•</button>
      </div>
      <div class="modal-body">
        <p>Editing username for: <strong id="username-edit-email"></strong></p>
        <div class="form-group">
          <label for="username-edit-input">New Username</label>
          <input type="text" id="username-edit-input" class="auth-input" placeholder="Enter new username">
        </div>
        <input type="hidden" id="username-edit-userid">
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeUsernameEditor()">Cancel</button>
        <button class="btn btn-primary" onclick="saveUsername()">Save Username</button>
      </div>
    </div>
  </div>

  <!-- Terms & Conditions Modal -->
  <div class="modal" id="terms-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>âš–ï¸ Terms & Conditions</h2>
        <button class="modal-close-btn-inline" onclick="closeTermsModal()">âœ•</button>
      </div>
      <div class="modal-body terms-content">
        <p>Last updated: February 1, 2026</p>

        <h3>1. Acceptance of Terms</h3>
        <p>By accessing the Irish Fishing Hub, you agree to be bound by these Terms and Conditions and all applicable
          laws and regulations in Ireland.</p>

        <h3>2. Use of Data</h3>
        <p>Tidal and weather data provided by this application is for informational and recreational fishing purposes
          only. Do not rely on this data for maritime navigation or safety-critical decisions. Always consult official
          Marine Institute (Ireland) notices and local harbor master reports.</p>
        <p><strong>Location Accuracy:</strong> All fishing, shop, and facility locations provided are for guidance only
          and may not be 100% accurate. It is the user's responsibility to verify and find the exact location. Irish
          Fishing Hub serves only as a guide.</p>

        <h3>3. Real-Time Data Accuracy</h3>
        <p>While we strive to provide real-time data from the Marine Institute sensor network, we cannot guarantee 100%
          uptime or accuracy. Data may be delayed or estimated during sensor maintenance or network outages.</p>

        <h3>4. Pro Subscription</h3>
        <p>Pro features are provided on a monthly subscription basis. Subscriptions can be cancelled at any time through
          the user profile menu.</p>

        <h3>5. Limitation of Liability</h3>
        <p>Irish Fishing Hub shall not be held liable for any loss, damage, or injury resulting from the use of data
          provided through this service.</p>

        <h3>7. Third-Party Links & Advertising Redirects</h3>
        <p>This platform is supported by advertising to remain free for all users. Certain platform interactions (such
          as
          using navigation buttons or viewing deep archives) may occasionally trigger a redirect to a third-party
          advertiser's landing page or offer via an Adsterra SmartLink. By using this service, you acknowledge and agree
          to these advertising practices as a condition of free access.</p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="closeTermsModal()">I Understand</button>
      </div>
    </div>
  </div>

  <!-- Privacy Policy Modal -->
  <div class="modal" id="privacy-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>ğŸ›¡ï¸ Privacy Policy</h2>
        <button class="modal-close-btn-inline" onclick="closePrivacyModal()">âœ•</button>
      </div>
      <div class="modal-body terms-content">
        <p>Last updated: February 1, 2026</p>

        <h3>1. Introduction</h3>
        <p>Irish Fishing Hub ("we", "our", or "us") values your privacy. This Privacy Policy explains how we collect,
          use, disclose, and safeguard your information when you use our web application.</p>

        <h3>2. Information We Collect</h3>

        <h4>2.1 Account Information</h4>
        <p><strong>What we collect:</strong> Email address, username, and password (encrypted)</p>
        <p><strong>Why:</strong> To create and manage your account, enable Pro features, and provide personalized
          services</p>
        <p><strong>Storage:</strong> Securely stored via Firebase Authentication and Realtime Database</p>

        <h4>2.2 User-Generated Content</h4>
        <p><strong>What we collect:</strong> Catch reports, photos, comments, fishing locations, and community posts you
          choose to share</p>
        <p><strong>Why:</strong> To enable community features and share fishing information with other users</p>
        <p><strong>Visibility:</strong> Content you post is visible to other users based on your privacy settings</p>

        <h4>2.3 Usage Data</h4>
        <p><strong>What we collect:</strong> Pages visited, features used, time spent on app, device type, browser type
        </p>
        <p><strong>Why:</strong> To improve our services, fix bugs, and understand user behavior</p>

        <h4>2.4 Location Data</h4>
        <p><strong>What we collect:</strong> Fishing locations you mark on the map (optional)</p>
        <p><strong>Why:</strong> To show fishing spots and provide location-based tide data</p>
        <p><strong>Note:</strong> We do not track your real-time location unless you explicitly share it</p>

        <h3>3. How We Use Your Information</h3>
        <ul>
          <li>Provide tide data, weather forecasts, and fishing conditions</li>
          <li>Enable community features (posting, commenting, liking)</li>
          <li>Process Pro subscription payments via Stripe</li>
          <li>Send important account notifications and updates</li>
          <li>Improve and optimize our services</li>
          <li>Respond to support requests</li>
          <li>Display relevant advertisements via Adsterra</li>
        </ul>

        <h3>4. Third-Party Services</h3>
        <p>We use the following third-party services that may collect your data:</p>

        <p><strong>Firebase (Google):</strong> Database and authentication. <a
            href="https://firebase.google.com/support/privacy" target="_blank">Privacy Policy</a></p>

        <p><strong>Stripe:</strong> Payment processing for Pro subscriptions. <a href="https://stripe.com/privacy"
            target="_blank">Privacy Policy</a></p>

        <p><strong>Adsterra:</strong> We use Adsterra to display advertisements and facilitate monetized redirects
          (SmartLinks). Adsterra and its partners may use cookies and similar technologies to collect information about
          your visits to this and other websites to provide relevant ads and track redirect conversions.
          You can manage your ad preferences via your browser settings.
          <a href="https://adsterra.com/privacy-policy/" target="_blank">Learn more</a>
        </p>

        <h3>5. Data Sharing</h3>
        <p><strong>We do NOT sell your personal data.</strong></p>
        <p>We only share data with:</p>
        <ul>
          <li>Firebase (database hosting)</li>
          <li>Stripe (payment processing)</li>
          <li>Adsterra (advertising)</li>
          <li>Other users (only content you choose to post publicly)</li>
        </ul>

        <h3>6. Cookies and Tracking</h3>
        <p>We use essential cookies to:</p>
        <ul>
          <li>Keep you logged in</li>
          <li>Remember your preferences</li>
          <li>Enable Adsterra advertising functionality</li>
        </ul>
        <p>You can disable cookies in your browser settings, but some features may not work properly.</p>

        <h3>7. Your Rights (GDPR)</h3>
        <p>If you are in the EU/EEA, you have the right to:</p>
        <ul>
          <li><strong>Access:</strong> Request a copy of your data</li>
          <li><strong>Rectification:</strong> Correct inaccurate data</li>
          <li><strong>Erasure:</strong> Request deletion of your data</li>
          <li><strong>Portability:</strong> Receive your data in a portable format</li>
          <li><strong>Objection:</strong> Object to data processing</li>
        </ul>
        <p>To exercise these rights, contact us via the support form in your profile.</p>

        <h3>8. Data Retention</h3>
        <p>We retain your data for as long as your account is active. If you delete your account, we will delete your
          personal data within 30 days, except where required by law.</p>

        <h3>9. Children's Privacy</h3>
        <p>Our service is not intended for users under 18. We do not knowingly collect data from children. If you
          believe a child has provided us with personal data, please contact us immediately.</p>

        <h3>10. Security</h3>
        <p>We use industry-standard security measures including:</p>
        <ul>
          <li>Encrypted passwords (bcrypt)</li>
          <li>HTTPS/SSL encryption</li>
          <li>Firebase security rules</li>
          <li>Regular security audits</li>
        </ul>
        <p>However, no method of transmission over the internet is 100% secure.</p>

        <h3>11. Changes to This Policy</h3>
        <p>We may update this Privacy Policy from time to time. We will notify you of significant changes via email or a
          prominent notice in the app.</p>

        <h3>12. Contact Us</h3>
        <p>If you have questions about this Privacy Policy, contact us via the support form in your profile settings.
        </p>
      </div>
      <div class="modal-footer">
        <button class="btn btn-primary" onclick="closePrivacyModal()">I Understand</button>
      </div>
    </div>
  </div>

  <!-- Mandatory Legal Consent Overlay -->
  <div class="legal-overlay hidden" id="legal-consent-overlay">
    <div class="legal-consent-card">
      <div class="legal-header">
        <div class="legal-logo">ğŸŒŠ</div>
        <h1>Legal Update</h1>
        <p>Please review and accept our updated terms to continue.</p>
      </div>

      <div class="legal-checklist">
        <label class="legal-item">
          <input type="checkbox" id="check-terms" onchange="updateLegalContinueButton()">
          <span class="custom-check"></span>
          <span class="legal-text">I accept the <a href="#" onclick="openTermsModal()">Terms & Conditions</a></span>
        </label>

        <label class="legal-item">
          <input type="checkbox" id="check-privacy" onchange="updateLegalContinueButton()">
          <span class="custom-check"></span>
          <span class="legal-text">I accept the <a href="#" onclick="openPrivacyModal()">Privacy Policy</a></span>
        </label>
      </div>

      <p class="legal-note">By clicking "Agree & Continue", you confirm you are over 18 or have parental consent to use
        this fishing hub.</p>

      <button id="legal-continue-btn" class="btn btn-primary btn-full" disabled onclick="acceptLegal()">
        Agree & Continue
      </button>

      <div class="legal-support"
        style="margin-top: 20px; text-align: center; border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
        <p style="font-size: 0.85rem; color: rgba(255,255,255,0.6); margin-bottom: 10px;">Questions about our terms or
          privacy?</p>
        <button class="btn btn-sm btn-outline" onclick="openSupportModal()"
          style="width: 100%; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; gap: 8px;">
          <span>ğŸ’¬</span> Contact Support Chat
        </button>
        <p style="font-size: 0.75rem; color: rgba(255,255,255,0.4);">For extra support: <a
            href="mailto:irishfishinghub@gmail.com"
            style="color: #4facfe; text-decoration: none;">irishfishinghub@gmail.com</a></p>
      </div>
    </div>
  </div>

  <!-- Report Comment Modal -->
  <div class="modal" id="report-comment-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Report Comment</h2>
        <button class="modal-close" onclick="closeReportModal()">Ã—</button>
      </div>
      <div class="modal-body">
        <p class="report-comment-text" id="report-comment-text"></p>

        <div class="form-group">
          <label>Reason for reporting:</label>
          <select id="report-reason" class="form-input">
            <option value="spam">Spam</option>
            <option value="harassment">Harassment or Bullying</option>
            <option value="inappropriate">Inappropriate Content</option>
            <option value="misinformation">Misinformation</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="form-group">
          <label>Additional details (optional):</label>
          <textarea id="report-details" class="form-input" rows="3" placeholder="Provide more context..."></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" onclick="closeReportModal()">Cancel</button>
        <button class="btn btn-primary" onclick="submitReport()">Submit Report</button>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <!-- Support Choice Modal -->
  <div class="modal" id="support-choice-modal">
    <div class="modal-content support-choice-card">
      <div class="modal-header">
        <h2>ğŸ’¬ Contact Support</h2>
        <button class="modal-close-btn-inline" onclick="closeSupportChoiceModal()">âœ•</button>
      </div>
      <div class="modal-body">
        <p style="text-align: center; color: rgba(255,255,255,0.7); margin-bottom: 25px;">
          How would you like to contact us?
        </p>
        <div class="support-options-grid">
          <button class="support-option-btn" onclick="handleInAppSupport()">
            <div class="support-option-icon">ğŸ’¬</div>
            <div class="support-option-info">
              <span class="support-option-title">In-App Chat</span>
              <span class="support-option-desc">Message us directly in the app</span>
            </div>
          </button>

          <a href="mailto:irishfishinghub@gmail.com" class="support-option-btn" style="text-decoration: none;">
            <div class="support-option-icon">ğŸ“§</div>
            <div class="support-option-info">
              <span class="support-option-title">Email Support</span>
              <span class="support-option-desc">irishfishinghub@gmail.com</span>
            </div>
          </a>
        </div>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/suncalc@1.9.0/suncalc.min.js"></script>
  <script src="https://js.stripe.com/v3/"></script>
  <script src="app.js"></script>
  <script src="sponsors.js"></script>
</body>

</html>